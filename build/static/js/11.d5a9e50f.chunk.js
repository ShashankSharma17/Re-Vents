(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{803:function(e,t,n){var r=n(833),a=36e5,c=6e4,o=2,i=/[T ]/,s=/:/,u=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],d=/^(\d{4})/,p=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],f=/^-(\d{2})$/,h=/^-?(\d{3})$/,v=/^-?(\d{2})-?(\d{2})$/,m=/^-?W(\d{2})$/,b=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,y=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,x=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,O=/([Z+-].*)$/,w=/^(Z)$/,j=/^([+-])(\d{2})$/,k=/^([+-])(\d{2}):?(\d{2})$/;function L(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!==typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var E=function(e){var t,n={},r=e.split(i);if(s.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var a=O.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),D=function(e,t){var n,r=l[t],a=p[t];if(n=d.exec(e)||a.exec(e)){var c=n[1];return{year:parseInt(c,10),restDateString:e.slice(c.length)}}if(n=u.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(E.date,n),S=D.year,I=function(e,t){if(null===t)return null;var n,r,a,c;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=f.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=h.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=v.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var i=parseInt(n[2],10);return r.setUTCFullYear(t,a,i),r}if(n=m.exec(e))return c=parseInt(n[1],10)-1,L(t,c);if(n=b.exec(e)){c=parseInt(n[1],10)-1;var s=parseInt(n[2],10)-1;return L(t,c,s)}return null}(D.restDateString,S);if(I){var T,F=I.getTime(),C=0;return E.time&&(C=function(e){var t,n,r;if(t=g.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=y.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*c;if(t=x.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*a+r*c+1e3*o}return null}(E.time)),E.timezone?T=function(e){var t,n;return(t=w.exec(e))?0:(t=j.exec(e))?(n=60*parseInt(t[2],10),"+"===t[1]?-n:n):(t=k.exec(e))?(n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n):0}(E.timezone):(T=new Date(F+C).getTimezoneOffset(),T=new Date(F+C+T*c).getTimezoneOffset()),new Date(F+C+T*c)}return new Date(e)}},809:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return o});var r=n(162),a=function(){return{type:r.c}},c=function(){return{type:r.b}},o=function(){return{type:r.a}}},812:function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(129);t.a=function(e){var t=e.input,n=e.width,r=e.type,o=e.placeholder,i=e.meta,s=i.touched,u=i.error;return a.a.createElement(c.i.Field,{error:s&&!!u,width:n},a.a.createElement("input",Object.assign({},t,{placeholder:o,type:r})),s&&u&&a.a.createElement(c.o,{basic:!0,color:"red"},u))}},814:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return u});var r=n(26),a=n(47),c=n(808),o=n.n(c),i=function(e){if(e)return Object.entries(e).map(function(e){return Object.assign(e[1],{id:e[0]})})},s=function(e,t,n){return n.date=o()(n.date).toDate(),Object(a.a)({},n,{hostUid:e.uid,hostedBy:e.displayName,hostPhotoURL:t||"/assets/user.png",created:Date.now(),attendees:Object(r.a)({},e.uid,{going:!0,joinDate:Date.now(),photoURL:t||"/assets/user.png",displayName:e.displayName,host:!0})})},u=function(e){var t=Object.create(null);e.forEach(function(e){return t[e.id]=Object(a.a)({},e,{childNodes:[]})});var n=[];return e.forEach(function(e){e.parentId?t[e.parentId].childNodes.push(t[e.id]):n.push(t[e.id])}),n}},815:function(e,t,n){var r=n(803);e.exports=function(e,t){var n=r(e).getTime(),a=r(t).getTime();return n<a?-1:n>a?1:0}},819:function(e,t,n){"use strict";n.d(t,"c",function(){return m}),n.d(t,"e",function(){return b}),n.d(t,"b",function(){return g}),n.d(t,"d",function(){return y}),n.d(t,"a",function(){return x});var r=n(47),a=n(806),c=n.n(a),o=n(807),i=n(808),s=n.n(i),u=n(159),l=n(814),d=n(219),p=n(809),f=n(131),h=n(815),v=n.n(h),m=function(e){return function(){var t=Object(o.a)(c.a.mark(function t(n,r,a){var o,i,s,d,p,f;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=a.getFirestore,i=o(),s=i.auth().currentUser,d=r().firebase.profile.photoURL,p=Object(l.b)(s,d,e),t.prev=5,t.next=8,i.add("events",p);case 8:return f=t.sent,t.next=11,i.set("event_attendee/".concat(f.id,"_").concat(s.uid),{eventId:f.id,userUid:s.uid,eventDate:e.date,host:!0});case 11:u.toastr.success("Success!","Event has been created"),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(5),u.toastr.error("Oops","Something went wrong");case 17:case"end":return t.stop()}},t,null,[[5,14]])}));return function(e,n,r){return t.apply(this,arguments)}}()},b=function(e){return function(){var t=Object(o.a)(c.a.mark(function t(n,r){var a,o,i,l,f,h,m,b;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n(Object(p.c)()),a=d.a.firestore(),e.date=s()(e.date).toDate(),t.prev=3,o=a.collection("events").doc(e.id),0===v()(r().firestore.ordered.events[0].date,e.date)){t.next=31;break}return i=a.batch(),t.next=10,i.update(o,e);case 10:return l=a.collection("event_attendee"),t.next=13,l.where("eventId","==",e.id);case 13:return f=t.sent,t.next=16,f.get();case 16:h=t.sent,m=0;case 18:if(!(m<h.docs.length)){t.next=27;break}return t.next=21,a.collection("event_attendee").doc(h.docs[m].id);case 21:return b=t.sent,t.next=24,i.update(b,{eventDate:e.date});case 24:m++,t.next=18;break;case 27:return t.next=29,i.commit();case 29:t.next=33;break;case 31:return t.next=33,o.update(e);case 33:n(Object(p.b)()),u.toastr.success("Success!","Event has been updated"),t.next=41;break;case 37:t.prev=37,t.t0=t.catch(3),n(Object(p.a)()),u.toastr.error("Oops","Something went wrong");case 41:case"end":return t.stop()}},t,null,[[3,37]])}));return function(e,n){return t.apply(this,arguments)}}()},g=function(e,t){return function(){var n=Object(o.a)(c.a.mark(function n(r,a,o){var i,s,l;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:i=o.getFirestore,s=i(),l=e?"Are you sure you want to cancel the event?":"This will reactivate the event - are you sure?\xcc";try{u.toastr.confirm(l,{onOk:function(){return s.update("events/".concat(t),{cancelled:e})}})}catch(r){console.log(r)}case 4:case"end":return n.stop()}},n)}));return function(e,t,r){return n.apply(this,arguments)}}()},y=function(e){return function(){var t=Object(o.a)(c.a.mark(function t(n,a){var o,i,s,u,l,h,v,m,b;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=new Date(Date.now()),i=d.a.firestore(),s=i.collection("events"),t.prev=3,n(Object(p.c)()),t.t0=e,!t.t0){t.next=10;break}return t.next=9,i.collection("events").doc(e.id).get();case 9:t.t0=t.sent;case 10:return u=t.t0,l=e?s.where("date",">=",o).orderBy("date").startAfter(u).limit(2):s.where("date",">=",o).orderBy("date").limit(2),t.next=14,l.get();case 14:if(0!==(h=t.sent).docs.length){t.next=18;break}return n(Object(p.b)()),t.abrupt("return",h);case 18:for(v=[],m=0;m<h.docs.length;m++)b=Object(r.a)({},h.docs[m].data(),{id:h.docs[m].id}),v.push(b);return n({type:f.c,payload:{events:v}}),n(Object(p.b)()),t.abrupt("return",h);case 25:t.prev=25,t.t1=t.catch(3),console.log(t.t1),n(Object(p.a)());case 29:case"end":return t.stop()}},t,null,[[3,25]])}));return function(e,n){return t.apply(this,arguments)}}()},x=function(e,t,n){return function(){var r=Object(o.a)(c.a.mark(function r(a,o,i){var s,l,d,p,f;return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s=i.getFirebase,l=s(),d=o().firebase.profile,p=l.auth().currentUser,f={parentId:n,displayName:d.displayName,photoURL:d.photoURL,uid:p.uid,text:t.comment,date:Date.now()},r.prev=5,r.next=8,l.push("event_chat/".concat(e),f);case 8:r.next=14;break;case 10:r.prev=10,r.t0=r.catch(5),console.log(r.t0),u.toastr.error("Oops","Problem adding comment");case 14:case"end":return r.stop()}},r,null,[[5,10]])}));return function(e,t,n){return r.apply(this,arguments)}}()}},825:function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(129);t.a=function(e){var t=e.input,n=e.rows,r=(e.type,e.placeholder),o=e.meta,i=o.touched,s=o.error;return a.a.createElement(c.i.Field,{error:i&&!!s},a.a.createElement("textarea",Object.assign({},t,{placeholder:r,rows:n})),i&&s&&a.a.createElement(c.o,{basic:!0,color:"red"},s))}},833:function(e,t){e.exports=function(e){return e instanceof Date}},835:function(e,t,n){"use strict";var r=n(47),a=n(153),c=n(154),o=n(156),i=n(155),s=n(157),u=n(0),l=n.n(u),d=n(129),p=n(871),f=n.n(p),h=n(892),v=n.n(h),m={autocompleteContainer:{zIndex:1e3}},b=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return(n=Object(o.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={scriptLoaded:!1},n.handleScriptLoaded=function(){return n.setState({scriptLoaded:!0})},n}return Object(s.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.input,n=e.width,a=e.onSelect,c=e.placeholder,o=e.options,i=e.meta,s=i.touched,u=i.error;return l.a.createElement(d.i.Field,{error:s&&!!u,width:n},l.a.createElement(f.a,{url:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDUX8SIqI2_TkxTUFkNQeqIyO4urAqgrt0&libraries=places",onLoad:this.handleScriptLoaded}),this.state.scriptLoaded&&l.a.createElement(v.a,{inputProps:Object(r.a)({},t,{placeholder:c}),options:o,onSelect:a,styles:m}),s&&u&&l.a.createElement(d.o,{basic:!0,color:"red"},u))}}]),t}(u.Component);t.a=b},893:function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(129);t.a=function(e){var t=e.input,n=(e.type,e.placeholder),r=e.multiple,o=e.options,i=e.meta,s=i.touched,u=i.error;return a.a.createElement(c.i.Field,{error:s&&!!u},a.a.createElement(c.u,{value:t.value||null,onChange:function(e,n){return t.onChange(n.value)},placeholder:n,options:o,multiple:r}),s&&u&&a.a.createElement(c.o,{basic:!0,color:"red"},u))}},894:function(e,t,n){"use strict";var r=n(816),a=n(0),c=n.n(a),o=n(129),i=n(906),s=(n(898),n(808)),u=n.n(s);t.a=function(e){var t=e.input,n=t.value,a=t.onChange,s=Object(r.a)(t,["value","onChange"]),l=e.width,d=e.placeholder,p=e.meta,f=p.touched,h=p.error,v=Object(r.a)(e,["input","width","placeholder","meta"]);return c.a.createElement(o.i.Field,{error:f&&!!h,width:l},c.a.createElement(i.a,Object.assign({},v,{placeholderText:d,selected:n?u()(n):null,onChange:a},s)),f&&h&&c.a.createElement(o.o,{basic:!0,color:"red"},h))}},963:function(e,t,n){"use strict";n.r(t);var r=n(806),a=n.n(r),c=n(807),o=n(153),i=n(154),s=n(156),u=n(155),l=n(157),d=n(0),p=n.n(d),f=n(129),h=n(838),v=n(837),m=n(130),b=n(871),g=n.n(b),y=n(834),x=n(892),O=n(158),w=n(819),j=n(812),k=n(825),L=n(893),E=n(894),D=n(835),S={createEvent:w.c,updateEvent:w.e,cancelToggle:w.b},I=[{key:"drinks",text:"Drinks",value:"drinks"},{key:"culture",text:"Culture",value:"culture"},{key:"film",text:"Film",value:"film"},{key:"food",text:"Food",value:"food"},{key:"music",text:"Music",value:"music"},{key:"travel",text:"Travel",value:"travel"}],T=Object(y.combineValidators)({title:Object(y.isRequired)({message:"The event title is required"}),category:Object(y.isRequired)({message:"Please provide a category"}),description:Object(y.composeValidators)(Object(y.isRequired)({message:"Please enter a description"}),Object(y.hasLengthGreaterThan)(4)({message:"Description needs to be at least 5 characters"}))(),city:Object(y.isRequired)("city"),venue:Object(y.isRequired)("venue"),date:Object(y.isRequired)("date")}),F=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={cityLatLng:{},venueLatLng:{},scriptLoaded:!1},n.handleScriptLoaded=function(){return n.setState({scriptLoaded:!0})},n.handleCitySelect=function(e){Object(x.geocodeByAddress)(e).then(function(e){return Object(x.getLatLng)(e[0])}).then(function(e){n.setState({cityLatLng:e})}).then(function(){n.props.change("city",e)})},n.handleVenueSelect=function(e){Object(x.geocodeByAddress)(e).then(function(e){return Object(x.getLatLng)(e[0])}).then(function(e){n.setState({venueLatLng:e})}).then(function(){n.props.change("venue",e)})},n.onFormSubmit=function(){var e=Object(c.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.venueLatLng=n.state.venueLatLng,!n.props.initialValues.id){e.next=8;break}return 0===Object.keys(t.venueLatLng).length&&(t.venueLatLng=n.props.event.venueLatLng),e.next=5,n.props.updateEvent(t);case 5:n.props.history.goBack(),e.next=10;break;case 8:n.props.createEvent(t),n.props.history.push("/events");case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(c.a)(a.a.mark(function e(){var t,n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.firestore,r=t.match,e.next=3,n.setListener("events/".concat(r.params.id));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){var e=Object(c.a)(a.a.mark(function e(){var t,n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.firestore,r=t.match,e.next=3,n.unsetListener("events/".concat(r.params.id));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.invalid,n=e.submitting,r=e.pristine,a=e.event,c=e.cancelToggle,o=e.loading;return p.a.createElement(f.j,null,p.a.createElement(g.a,{url:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDUX8SIqI2_TkxTUFkNQeqIyO4urAqgrt0&libraries=places",onLoad:this.handleScriptLoaded}),p.a.createElement(f.j.Column,{width:10},p.a.createElement(f.t,null,p.a.createElement(f.k,{sub:!0,color:"teal",content:"Event Details"}),p.a.createElement(f.i,{onSubmit:this.props.handleSubmit(this.onFormSubmit)},p.a.createElement(h.a,{name:"title",type:"text",component:j.a,placeholder:"Give your event a name"}),p.a.createElement(h.a,{name:"category",type:"text",component:L.a,options:I,placeholder:"What is your event about"}),p.a.createElement(h.a,{name:"description",type:"text",component:k.a,rows:3,placeholder:"Tell us about your event"}),p.a.createElement(f.k,{sub:!0,color:"teal",content:"Event Location Details"}),p.a.createElement(h.a,{name:"city",type:"text",component:D.a,options:{types:["(cities)"]},placeholder:"Event City",onSelect:this.handleCitySelect}),this.state.scriptLoaded&&p.a.createElement(h.a,{name:"venue",type:"text",component:D.a,options:{location:new google.maps.LatLng(this.state.cityLatLng),radius:1e3,types:["establishment"]},placeholder:"Event Venue",onSelect:this.handleVenueSelect}),p.a.createElement(h.a,{name:"date",type:"text",component:E.a,dateFormat:"YYYY-MM-DD HH:mm",timeFormat:"HH:mm",showTimeSelect:!0,placeholder:"Date and Time of Event"}),p.a.createElement(f.a,{loading:o,disabled:t||n||r,positive:!0,type:"submit"},"Submit"),p.a.createElement(f.a,{disabled:o,onClick:this.props.history.goBack,type:"button"},"Cancel"),a.id&&p.a.createElement(f.a,{onClick:function(){return c(!a.cancelled,a.id)},type:"button",floated:"right",color:a.cancelled?"green":"red",content:a.cancelled?"Reactivate event":"Cancel event"})))))}}]),t}(d.Component);t.default=Object(m.withFirestore)(Object(O.connect)(function(e,t){var n={};return e.firestore.ordered.events&&e.firestore.ordered.events[0]&&(n=e.firestore.ordered.events[0]),{initialValues:n,event:n,loading:e.async.loading}},S)(Object(v.a)({form:"eventForm",enableReinitialize:!0,validate:T})(F)))}}]);
//# sourceMappingURL=11.d5a9e50f.chunk.js.map